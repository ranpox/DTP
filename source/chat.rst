.. |br| raw:: html

    <br/>

闲聊型对话机器人
========================


基本概念
----------------

- 开发者：使用dtp闲聊功能进行闲聊机器人开发的人。
- 用户：与开发者开发的闲聊机器人进行交互从而期望获取一定信息并进行谈话的人。
- 机器人：一个机器人对应一个由上传语料构建而成的闲聊系统，用来作为能够回答一定问题的、达到某些告知和传递信息目的需求，同时对于未知的问题也能进行正常交流和闲谈，比如下例将要提到“公众号后台机器人”。
- 问题-回复对：开发者上传的问题和回复句对，开发者可以通过上传句对来对想要用户知晓的信息和用户可能提出的问题的答案进行设置。用户可以在输入界面完成句对的输入、编辑和删除，也可以在测试过程中实时地修改。
- 属性：机器人的一些属性，在设置完成后并提交后，当用户询问相关属性时，会根据填值自动生成回复。需要注意的是，如果开发者不希望以一个代理机器人的形式与用户交互，则不必设置任何属性。相关问题及其答案可以直接通过上述的问题-回复对来进行设置。
- 语料：问题-回复对的集合。用户可以手动输入，也可以上传一定格式的文件达到批量上传的目的。语料越多，覆盖的问题越广。
 
创建闲聊型机器人
--------------------

我们来创建一个公众号后台机器人，来模拟公众号后台以闲聊机器人的方式与用户进行交互。
 
首先我们以“程序员小毛”为例创建一个机器人：

.. figure:: https://dtp.oss-cn-beijing.aliyuncs.com/images/chat/chat-1.jpg
   :alt: 图 1
   :align: center

   图 1
 
创建完机器人之后，我们会进入机器人的语料添加界面，在这个界面里，开发者即可通过在线编辑或批量上传语料的方式，来进行个性化回复的定制。
首先我们在聊天语料界面，逐个输入问题和回复。回车或点击“添加”按钮，就可以将句对添加为语料并显示出来。点击“训练”即可完成机器人的训练。在之后每次修改语料或属性时，都需要重新训练模型来达到良好的效果。

.. figure:: https://dtp.oss-cn-beijing.aliyuncs.com/images/chat/chat-2.jpg
   :alt: 图 2
   :align: center

   图 2
 
训练完毕后，基于开发者的语料库就构建成功了。随后，用户可以在界面右侧的测试栏对模块进行测试。如图所示，当用户输入与问题相关的query语句时，dtp会自动将其与语料库中的问题进行检索，尝试去找出一个最相关的问题并将其回复作为query的回复。
如果上述的相关度并不是很高，则会触发“引导回答”：

.. figure:: https://dtp.oss-cn-beijing.aliyuncs.com/images/chat/chat-3.jpg
   :alt: 图 3
   :align: center

   图 3
 
比如：在上例中，当用户询问“业余时间你喜欢干嘛”，这句话与语料库中的“业余爱好”有一定的语义联系，但又并非直接询问爱好。这时就会触发“引导回答”。
又如：

.. figure:: https://dtp.oss-cn-beijing.aliyuncs.com/images/chat/chat-4.jpg
   :alt: 图 4
   :align: center

   图 4

  
在上图中，乍一看query与语料库中的“遮阳伞和太阳镜应该带哪个”并不是同一个问题，但query里的“防晒”与“遮阳伞和太阳镜”有一定的语义联系，所以“引导回答”将引导用户进行信息的获取。这使得开发者的语料能够得到更为充分的利用。
如果query与语料库中所有的问题相似度都较低，则会被拒识，最后会进行闲聊兜底。兜底模块除了多领域闲聊外，还具有一定的查询天气、新闻推荐和知识问答等功能。下图为拒识后进行查询天气领域的闲聊。

.. figure:: https://dtp.oss-cn-beijing.aliyuncs.com/images/chat/chat-5.jpg
   :alt: 图 5
   :align: center

   图 5
 
在测试过程中，如果对于机器人的回复不满意，或者想增加新的问答，可以随时通过测试栏对话中的“编辑当前轮”来对当前的对话进行编辑，并添加到语料。同样别忘了重新训练。

.. figure:: https://dtp.oss-cn-beijing.aliyuncs.com/images/chat/chat-6.jpg
   :alt: 图 6
   :align: center

   图 6
 
 
开发者还可以批量上传语料，通过上传事先编辑好的json文件，可以实现一次性多条语料的上传，约定文件格式样例如下：
{
"请做个自我介绍吧": "我叫小毛，是个程序猿", 
"你曾经参与开发过哪些项目": "我参加的项目可多啦", 
"你有什么业余爱好吗": "我喜欢打篮球、看电影、唱歌", 
"你现在工作的单位在哪": "在哈尔滨"
}
 
属性模块是在开发者希望以一个代理机器人的形式与用户交互，而非直接以自己的身份。这时，通过几个简单的属性值的设置，即可赋予机器人一定的属性。当用户询问与机器人的属性相关的问题时，dtp将直接生成包含属性的回复，从而作为与用户间的代理进行交互。与之前一样，用户可以通过上传语料的方式自定义回复。

.. figure:: https://dtp.oss-cn-beijing.aliyuncs.com/images/chat/chat-7.jpg
   :alt: 图 7
   :align: center

   图 7
 
欢迎开发者们来探索DTP闲聊型的潜力。
 
附：样例及说明
-----------------------
 
- 问答对：“请问你的github网址是多少？”--“github.com/google”
- query：“github”
- 得到直接回复：“github.com/google”
- 说明：具有提取关键信息的能力

|br|

- 问答对：“哈尔滨的冬天冷吗？”--“冷的很啊”
- query：“哈尔滨的夏天热吗”
- 得到引导回复：“你是想问我‘哈尔滨的冬天冷吗’， 那我会回答你‘冷的很啊’”
- 说明：并没有直接回复“冬天冷吗”的答案，而是采用引导回复，具有区分问题的能力

|br|

- 问答对：“你的爱好是什么”--“我更喜欢睡觉”
- query：“我会弹吉他吗”
- 得到引导回复：“你是想跟我聊‘你的爱好是什么对吗’，那我会告诉你‘我更喜欢睡觉’哦”
- 说明：具有一定的联想和引导的能力

|br|

- 问答对：无(语料未覆盖)
- query：“小米和华为哪个好用”
- 得到直接回复：“华为手机和小米手机侧重的市场不用，小米手机主打性价比同时性能非常强悍，华为手机主打自主处理器和拍照能力，主要侧重商务人士使用…”
- 说明：具有检索百科能力

|br|

- 问答对：无(语料未覆盖)
- query：“我要疯了”
- 得到直接回复：“淡定，跟我说说出了什么大事了，我们来聊聊天”
- 说明：可以与用户进行闲聊互动

 
 
